# AutoKey GUI（Windows 后台键入自动化工具）

AutoKey GUI 是一个基于 **Python + PyQt5 + Win32 API** 的 Windows 自动化工具，用于 **向指定窗口后台发送键盘输入**，不影响用户在前台进行其他操作。

该项目创建初衷是为了解决在游戏或其他应用中需要频繁重复按键的场景，提供一种简单、安全、可控的自动化解决方案。起因是我在minecraft服务器中需要极其逆天的长时间机械化操作，手动按键实在太累，于是萌生了开发此工具的想法。

这是我写的第一个开源项目，希望能帮助到有类似需求的人，也欢迎大家提出issue和PR，一起完善这个工具

---

> ⚠️ 仅供学习与合法自动化用途，请勿用于违反软件服务条款或法律法规的行为。

---

## 功能特性

### 窗口与后台键入

* 枚举当前所有可见窗口
* 选择目标窗口句柄（HWND）
* 使用 Win32 `PostMessage` 后台发送按键（不抢占焦点）

### 简单模式

* GUI 直接录制 **真实键盘组合键**（如 `CTRL+SHIFT+A`）
* 支持组合键循环按下 / 抬起
* 可设置按键间隔（秒，数值直观显示）

### 高级脚本模式（DSL）

支持简单脚本指令：

```text
DOWN CTRL
DOWN <KEY>      : 按下不抬起

UP CTRL
UP <KEY>        : 抬起按键

KEY C
KEY <KEY>       : 按下并抬起

WAIT 0.5
WAIT <SECONDS>  : 等待时间（秒）

LOOP 1 {        
    ...         
}               
LOOP <COUNT> {  : 循环块，COUNT 次
    ...         : 循环体
}               : 结束循环块
```


### 运行控制

* 开始 / 暂停 / 继续
* **重置按钮**：安全停止当前任务并恢复 Idle 状态
* 清晰的状态指示（Idle / Running / Paused）

### 全局热键（可视化）

* 默认热键：

  * **F8**：暂停 / 继续
  * **F9**：备用控制
* 基于 `pynput` 的全局监听
* 独立选项卡进行热键记录与显示

### 日志系统

* 独立日志选项卡
* 记录：

  * 任务启动 / 停止
  * 热键触发
  * 错误与警告
* 便于调试与行为回溯

---

## 项目结构

```text
autokey_gui/
│
├── main.py              # 程序入口
├── gui.py               # 主 GUI（选项卡 / 控制逻辑）
├── window_manager.py    # 窗口 / 句柄枚举
├── key_sender.py        # 后台按键发送（Win32）
├── keymap.py            # 全键盘虚拟键映射
├── simple_runner.py     # 简单模式运行逻辑
├── script_engine.py     # 高级脚本解析与执行
└── README.md
```


---

## 运行环境

* 操作系统：Windows 10 / 11
* Python：3.8+

### 依赖安装

```bash
pip install pyqt5 pywin32 pynput
```

---

## 使用说明

### 启动程序

```bash
python auto_key_gui_full.py
```

### 选择目标窗口
1. 在「窗口选择」选项卡中，点击 **刷新窗口列表** 按钮。
2. 从下拉菜单中选择目标窗口。

### 简单模式使用
1. 左键点击简单模式输入框。
2. 键入需要循环的按键或者组合键（如 `CTRL+SHIFT+A`）。
3. 设置按键间隔（秒）。
4. 点击 **开始** 按钮启动自动化。

### 高级脚本模式使用
1. 切换到脚本模式。
2. 在脚本编辑框中编写脚本指令。
3. 点击 **开始** 按钮启动自动化。

### 暂停/继续与重置
* 点击 **暂停** 按钮暂停当前任务，按钮文本变为 **继续**。
* 点击 **继续** 按钮恢复任务。
* 点击 **重置** 按钮停止当前任务并恢复 Idle 状态。

### 热键控制

* 任意窗口下按 **F8** → 暂停 / 继续
* 可在热键设置中设置热键绑定。

---

## 设计说明

* 不抢占窗口焦点
* 不注入 DLL、不 Hook
* 所有自动化逻辑可控、可暂停、可重置

---

## 后续更新计划（Roadmap）

以下功能已纳入后续更新规划，用于扩展 AutoKey GUI 在 **更复杂自动化 / 游戏与仿真场景** 下的能力：

### 鼠标输入支持

* 鼠标点击（左 / 右 / 中键）后台发送
* 鼠标按下 / 抬起（支持拖拽）
* 鼠标滚轮模拟
* 鼠标位置记录与回放

### 鼠标行为录制

* 实时录制用户鼠标轨迹（时间轴）
* 导出为脚本（与键盘 DSL 统一）
* 支持重放、循环、加速 / 减速

### 3D 游戏 / 视角类应用支持（研究向）

> 面向第一/第三人称视角控制场景

* 将 **鼠标位移映射为 3D 视角旋转（Yaw / Pitch）**
* 支持灵敏度曲线拟合
* 鼠标 ΔX / ΔY → 虚拟 3D 移动量

### 高级自动化能力

* 键盘 + 鼠标混合脚本
* 条件判断（基于窗口状态 / 时间）
* 脚本函数与宏复用

### 工程与体验增强

* 热键配置持久化（QSettings）
* 脚本语法高亮与自动补全
* 多任务 / 多窗口队列调度

